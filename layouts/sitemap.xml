{{ printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML }}
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:news="http://www.google.com/schemas/sitemap-news/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
        xmlns:mobile="http://www.google.com/schemas/sitemap-mobile/1.0"
        xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
        xmlns:video="http://www.google.com/schemas/sitemap-video/1.1">
  {{ range .Data.Pages }}
  {{ if .Permalink }}
  <url>
    <loc>{{ .Permalink }}</loc>
    {{ if not .Date.IsZero }}
    <lastmod>{{ .Date.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</lastmod>
    {{ end }}
    {{ with .Sitemap.ChangeFreq }}
    <changefreq>{{ . }}</changefreq>
    {{ end }}
    {{ if ge .Sitemap.Priority 0.0 }}
    <priority>{{ .Sitemap.Priority }}</priority>
    {{ end }}
    
    {{ if .IsHome }}
    <priority>1.0</priority>
    <changefreq>daily</changefreq>
    {{ else if in .Params.categories "news" }}
    <priority>0.9</priority>
    <changefreq>daily</changefreq>
    {{ else if eq .Type "categories" }}
    <priority>0.8</priority>
    <changefreq>weekly</changefreq>
    {{ else }}
    <priority>0.6</priority>
    <changefreq>monthly</changefreq>
    {{ end }}
    
    <!-- Add hreflang for multilingual support -->
    {{ if hugo.IsMultilingual }}
    {{ range site.Languages }}
    {{ if ne .Lang $.Language.Lang }}
    <xhtml:link 
      rel="alternate"
      hreflang="{{ .Lang }}" 
      href="{{ $.Permalink | replaceRE "^https?://[^/]+" site.BaseURL }}"
      />
    {{ end }}
    {{ end }}
    <xhtml:link 
      rel="alternate"
      hreflang="x-default" 
      href="{{ .Permalink }}"
      />
    {{ end }}
    
    <!-- Add image information for pages with featured images -->
    {{ if .Params.featured_image }}
    <image:image>
      <image:loc>{{ .Params.featured_image | absURL }}</image:loc>
      <image:title>{{ .Title }}</image:title>
      <image:caption>{{ if .Description }}{{ .Description }}{{ else }}{{ .Summary | truncate 160 }}{{ end }}</image:caption>
    </image:image>
    {{ end }}
    
  </url>
  {{ end }}
  {{ end }}
</urlset>
